<table class="table table-hover table-sm" style="width: 100%;">
    <thead class="table-light">
        <tr>
            <th><b-form-checkbox v-model="selected.all" :indeterminate='selected.indeterminate' @change='toggleAll'></b-form-checkbox></th>
            <th>{{I18N.t('file')}} <b-icon icon="sort-alpha-down"></b-icon></th>
            <th>{{I18N.t('size')}} </th>
            <th>{{I18N.t('modifyTime')}}</th>
            <th>{{I18N.t('operation')}}</th>
        </tr>
    </thead>
    <tbody>
        <tr v-for="(item, index) in children" v-model="children">
            <td> <b-form-checkbox :value="item" v-model='selected.items[index]' @change='toggleSelected'></b-form-checkbox></th>
            <td v-if='item.type=="folder"' v-on:click="clickPath(item)">
                <b-icon icon="folder-fill" variant="warning"></b-icon> {{item.name}}
                <p v-if='showPardir==true'><small class="text-muted">{{item.pardir}}</small>
                </p>
            </td>
            <td v-else>
                <b-icon icon="file-earmark-fill"></b-icon>
                <a :href="getFSUrl(item)" target="_blank"> {{item.name}}</a>
                <p v-if='showPardir==true'><small class="text-muted">{{item.pardir}}</small>
                </p>
            </td>
            <td>{{item.size}}</td>
            <td style="width: 120px">
                <span style="font-size: small;">{{item.modify_time}}</span>
            </td>
            <td>
                <button class="btn btn-sm btn-danger" v-on:click="makeSureDelete(item)" v-b-tooltip.hover :title="I18N.t('delete')">
                    <b-icon icon="trash"></b-icon>
                </button>
                <b-button class="btn btn-sm btn-warning" v-on:click="showRenameModal(item)"
                    v-b-modal.modal-rename v-b-tooltip.hover :title="I18N.t('rename')">
                    <b-icon icon="vr"></b-icon>
                </b-button>
                <a class="btn btn-sm btn-info" target='_blank' :href="getDownloadUrl(item)" v-b-tooltip.hover :title="I18N.t('download')">
                    <b-icon icon="download"></b-icon>
                </a>
                <b-button class="btn btn-sm btn-info" v-if="item.editable==true"
                    v-on:click="showFileModal(item)" v-b-modal.modal-file v-b-tooltip.hover
                    :title="I18N.t('view')">
                    <b-icon icon="eye"></b-icon>
                </b-button>
                <b-button class="btn btn-sm btn-info" v-on:click="setFileQrcode(item)" v-if="item.type!='folder'"
                    v-b-modal.modal-filelink v-b-tooltip.hover :title="I18N.t('displayQRCode')">
                    <b-icon icon="upc-scan"></b-icon>
                </b-button>
            </td>
        </tr>
    </tbody>
</table>

<!-- Modal file content -->
<b-modal id="modal-file" size="lg" :title="fileEditor.name"  hide-footer>
    <textarea class="form-control" v-model="fileEditor.content" cols="30" rows="20"></textarea>
</b-modal>

<!-- Modal qrcode -->
<b-modal id="modal-filelink" :title="downloadFile.name" @shown="showFileQrcode()"  hide-footer>
    <div id='fileQrcode' style="width: 50%; margin: 0 auto "></div>
</b-modal>

<!-- Modal rename -->
<b-modal id="modal-rename" :title="I18N.t('rename')" @ok="renameDir()" >
    <div class="mb-3">
        <label for="exampleFormControlInput1" class="form-label">{{I18N.t('filename')}}</label>
        <b-form-input class="form-control" :value="renameItem.name" disabled></b-form-input>
    </div>
    <div class="mb-3">
        <label for="exampleFormControlTextarea1" class="form-label">{{I18N.t('newFileName')}}</label>
        <b-form-input class="form-control" v-model="renameItem.newName" required></b-form-input>
    </div>
    <template #modal-footer>
        <b-button block variant="warning" v-on:click="renameDir()">{{I18N.t('rename')}}</b-button>
    </template>
</b-modal>
